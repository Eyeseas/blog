<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="keywords" content="ESLint中文, ESLint中文网, ESLint规则, ESLint配置, 代码检测, 代码质量, JavaScript, Linter, Linting, Pluggable, Configurable, Code Quality">
  <meta name="description" content="ESLint中文官网, ESLint中英文对照, JavaScript代码检测, JavaScript代码风格检测, JavaScript代码自动格式化,A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease.">
  <meta name="theme-color" content="#463fd4"/>
  <meta property="og:locale" content="zh_CN">
  <meta property="og:site_name" content="ESLint中文">
  <meta property="og:title" content="Migrating to v2.0.0">
  <meta property="og:url" content="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-2.0.0">
  <meta property="og:image" content="http://localhost:4000/img/favicon.512x512.png">

  <meta name="twitter:site" content="@geteslint">
  <meta name="twitter:title" content="Migrating to v2.0.0">
  <meta name="twitter:description" content="ESLint中文官网, ESLint中英文对照, JavaScript代码检测, JavaScript代码风格检测, JavaScript代码自动格式化,A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease.">
  <meta name="twitter:url" content="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-2.0.0">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="http://localhost:4000/img/favicon.512x512.png">

    
        <title>Migrating to v2.0.0 - ESLint中文</title>
    


  <link href="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-2.0.0" rel="canonical" />
  <link rel="stylesheet" href="/styles/main.css"/>
  
  <link rel="stylesheet" href="/styles/mixed.css"/>
  
  <link rel='manifest' href='http://localhost:4000/manifest.json'>
  <link rel="icon" href="http://localhost:4000/img/favicon.512x512.png">
  <link rel="alternate" type="application/rss+xml" title="ESLint中文" href="http://localhost:4000/feed.xml">
  <!-- at the end of the HEAD -->
  <link rel="stylesheet" href="/styles/vendor/docsearch.min.css" />
</head>
<body>

<input type="checkbox" id="eslint-toggle-search" class="eslint-toggle-search-checkbox" />
<header class="navbar navbar-default navbar-demo navbar-fixed-top eslint-nav" id="top" role="banner">
  <div class="container">

    <a href="http://localhost:4000/" class="navbar-brand"><img alt="ESLint" src="http://localhost:4000/img/logo.svg" itemprop="image">ESLint</a>

    <div class="eslint-navbar-toggles">
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#eslint-navbar" aria-controls="eslint-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open">
        <span class="sr-only">Open search</span>
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </label>
    </div>

    <nav id="eslint-navbar" class="collapse navbar-collapse eslint-navbar">
      
      <ul class="nav navbar-nav navbar-left">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="lang-chooser">中文</span><span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a class="lang-type" data-lang="zh" href="javascript:;">中文</a></li>
            <li><a class="lang-type" data-lang="mixed" href="javascript:;">中英文</a></li>
            <li><a class="lang-type" data-lang="en" href="javascript:;">英文</a></li>
          </ul>
        </li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="http://localhost:4000/docs/user-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">用户指南<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/docs/user-guide/getting-started">开始</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/configuring">配置</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/command-line-interface">命令行</a></li>
            <li><a href="http://localhost:4000/docs/rules/">规则</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/formatters">Formatters</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/integrations">集成</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="http://localhost:4000/docs/developer-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">开发指南<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/docs/developer-guide/architecture">架构</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/source-code">源码</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/development-environment">开发环境</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/contributing">参与</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/unit-tests">单元测试</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-rules">创建规则</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-custom-formatters">自定义格式化器</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-custom-parsers">自定义解析器</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-plugins">开发插件</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/shareable-configs">可共享的配置</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/nodejs-api">Node.js API</a></li>
            <li><a href="http://localhost:4000/docs/maintainer-guide">维护者指南</a></li>
          </ul>
        </li>
        <li><a href="http://localhost:4000/blog/">博客</a></li>
        <li class="dropdown">
          <a href="http://localhost:4000/demo" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">演示<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/demo/">ESLint Demo</a></li>
            <li><a href="http://localhost:4000/parser/">Espree Demo</a></li>
          </ul>
        </li>
        <!-- <li><a href="http://localhost:4000/docs/about/">About</a></li> -->
        <li class="dropdown">
          <a href="http://localhost:4000/docs/about/" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">关于<span
              class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/users/">谁在使用 ESLint?</a></li>
            <li><a href="http://localhost:4000/team/">关于 Team</a></li>
            <li><a href="http://localhost:4000/docs/about/">关于 ESLint</a></li>
          </ul>
        </li>
      </ul>

      <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open">
        <span class="sr-only">Open search</span>
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </label>

      <div class="navbar-form navbar-right eslint-search" role="search">
        <div class="input-group">
          <label class="sr-only" aria-label="Search" for="eslint-search-input">Search</label>
          <div class="eslint-search-input-wrapper">
            <input type="text" class="form-control" id="eslint-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search the docs...">
            <label for="eslint-toggle-search" class="eslint-toggle-search-close">
              <span class="sr-only">Close search</span>
              <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
            </label>
          </div>
        </div>
      </div>
    </nav>

  </div><!-- /.container -->
</header><!-- /.navbar -->

<main class="doc lang-zh">
  <article class="container">
    <!-- Note: No pull requests accepted for this file. See README.md in the root directory for details. -->

<h1 id="migrating-to-v200">Migrating to v2.0.0</h1>

<p>ESLint v2.0.0 is the second major version release. As a result, there are some significant changes between how ESLint worked during its life in 0.x and 1.x and how it will work going forward. These changes are the direct result of feedback from the ESLint community of users and were not made without due consideration for the upgrade path. We believe that these changes make ESLint even better, and while some work is necessary to upgrade, we hope the pain of this upgrade is small enough that you will see the benefit of upgrading.</p>

<p><strong>Important:</strong> If you are upgrading from 0.x, please refer to <a href="./migrating-to-1.0.0">Migrating to 1.0.0</a> as your starting point.</p>

<h2 id="rule-schema-changes">Rule Schema Changes</h2>

<p>Due to a quirk in the way rule schemas worked, it was possible that you’d need to account for the rule severity (0, 1, or 2) in a rule schema if the options were sufficiently complex. That would result in a schema such as:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">array</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">items</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="dl">"</span><span class="s2">enum</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="dl">"</span><span class="s2">enum</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">always</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">never</span><span class="dl">"</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="dl">"</span><span class="s2">minItems</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">maxItems</span><span class="dl">"</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">};</span>
</code></pre></div></div>

<p>This was confusing to rule developers as it seemed that rules shouldn’t be in charge of validating their own severity. In 2.0.0, rules no longer need to check their own severity.</p>

<p><strong>To address:</strong> If you are exporting a rule schema that checks severity, you need to make several changes:</p>

<ol>
  <li>Remove the severity from the schema</li>
  <li>Adjust <code class="language-plaintext highlighter-rouge">minItems</code> from 1 to 0</li>
  <li>Adjust <code class="language-plaintext highlighter-rouge">maxItems</code> by subtracting 1</li>
</ol>

<p>Here’s what the schema from above looks like when properly converted:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">array</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">items</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="dl">"</span><span class="s2">enum</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">always</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">never</span><span class="dl">"</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="dl">"</span><span class="s2">minItems</span><span class="dl">"</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">maxItems</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">};</span>
</code></pre></div></div>

<h2 id="removed-rules">Removed Rules</h2>

<p>The following rules have been deprecated with new rules created to take their place. The following is a list of the removed rules and their replacements:</p>

<ul>
  <li><a href="https://eslint.org/docs/rules/no-arrow-condition">no-arrow-condition</a> is replaced by a combination of <a href="https://eslint.org/docs/rules/no-confusing-arrow">no-confusing-arrow</a> and <a href="https://eslint.org/docs/rules/no-constant-condition">no-constant-condition</a>. Turn on both of these rules to get the same functionality as <code class="language-plaintext highlighter-rouge">no-arrow-condition</code>.</li>
  <li><a href="https://eslint.org/docs/rules/no-empty-label">no-empty-label</a> is replaced by <a href="https://eslint.org/docs/rules/no-labels">no-labels</a> with <code class="language-plaintext highlighter-rouge">{"allowLoop": true, "allowSwitch": true}</code> option.</li>
  <li><a href="https://eslint.org/docs/rules/space-after-keywords">space-after-keywords</a> is replaced by <a href="https://eslint.org/docs/rules/keyword-spacing">keyword-spacing</a>.</li>
  <li><a href="https://eslint.org/docs/rules/space-before-keywords">space-before-keywords</a> is replaced by <a href="https://eslint.org/docs/rules/keyword-spacing">keyword-spacing</a>.</li>
  <li><a href="https://eslint.org/docs/rules/space-return-throw-case">space-return-throw-case</a> is replaced by <a href="https://eslint.org/docs/rules/keyword-spacing">keyword-spacing</a>.</li>
</ul>

<p><strong>To address:</strong> You’ll need to update your rule configurations to use the new rules. ESLint v2.0.0 will also warn you when you’re using a rule that has been removed and will suggest the replacement rules. Hopefully, this will result in few surprises during the upgrade process.</p>

<h2 id="configuration-cascading-changes">Configuration Cascading Changes</h2>

<p>Prior to 2.0.0, if a directory contained both an <code class="language-plaintext highlighter-rouge">.eslintrc</code> file and a <code class="language-plaintext highlighter-rouge">package.json</code> file with ESLint configuration information, the settings from the two files would be merged together. In 2.0.0, only the settings from the <code class="language-plaintext highlighter-rouge">.eslintrc.*</code> file are used and the ones in <code class="language-plaintext highlighter-rouge">package.json</code> are ignored when both are present. Otherwise, <code class="language-plaintext highlighter-rouge">package.json</code> can still be used with ESLint configuration, but only if no other <code class="language-plaintext highlighter-rouge">.eslintrc.*</code> files are present.</p>

<p><strong>To address:</strong> If you have both an <code class="language-plaintext highlighter-rouge">.eslintrc.*</code> and <code class="language-plaintext highlighter-rouge">package.json</code> with ESLint configuration information in the same directory, combine your configurations into just one of those files.</p>

<h2 id="built-in-global-variables">Built-In Global Variables</h2>

<p>Prior to 2.0.0, new global variables that were standardized as part of ES6 such as <code class="language-plaintext highlighter-rouge">Promise</code>, <code class="language-plaintext highlighter-rouge">Map</code>, <code class="language-plaintext highlighter-rouge">Set</code>, and <code class="language-plaintext highlighter-rouge">Symbol</code> were included in the built-in global environment. This could lead to potential issues when, for example, <code class="language-plaintext highlighter-rouge">no-undef</code> permitted use of the <code class="language-plaintext highlighter-rouge">Promise</code> constructor even in ES5 code where promises are unavailable. In 2.0.0, the built-in environment only includes the standard ES5 global variables, and the new ES6 global variables have been moved to the <code class="language-plaintext highlighter-rouge">es6</code> environment.</p>

<p><strong>To address:</strong> If you are writing ES6 code, enable the <code class="language-plaintext highlighter-rouge">es6</code> environment if you have not already done so:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// In your .eslintrc</span>
<span class="p">{</span>
    <span class="nl">env</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">es6</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Or in a configuration comment</span>
<span class="cm">/*eslint-env es6*/</span>
</code></pre></div></div>

<h2 id="language-options">Language Options</h2>

<p>Prior to 2.0.0, the way to enable language options was by using <code class="language-plaintext highlighter-rouge">ecmaFeatures</code> in your configuration. In 2.0.0:</p>

<ul>
  <li>The <code class="language-plaintext highlighter-rouge">ecmaFeatures</code> property is now under a top-level <code class="language-plaintext highlighter-rouge">parserOptions</code> property.</li>
  <li>All ECMAScript 6 <code class="language-plaintext highlighter-rouge">ecmaFeatures</code> flags have been removed in favor of a <code class="language-plaintext highlighter-rouge">ecmaVersion</code> property under <code class="language-plaintext highlighter-rouge">parserOptions</code> that can be set to 3, 5 (default), or 6.</li>
  <li>The <code class="language-plaintext highlighter-rouge">ecmaFeatures.modules</code> flag has been replaced by a <code class="language-plaintext highlighter-rouge">sourceType</code> property under <code class="language-plaintext highlighter-rouge">parserOptions</code> which can be set to <code class="language-plaintext highlighter-rouge">"script"</code> (default) or <code class="language-plaintext highlighter-rouge">"module"</code> for ES6 modules.</li>
</ul>

<p><strong>To address:</strong> If you are using any ECMAScript 6 feature flags in <code class="language-plaintext highlighter-rouge">ecmaFeatures</code>, you’ll need to use <code class="language-plaintext highlighter-rouge">ecmaVersion: 6</code> instead. The ECMAScript 6 feature flags are:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">arrowFunctions</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-arrow-functions">arrow functions</a></li>
  <li><code class="language-plaintext highlighter-rouge">binaryLiterals</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-octal-and-binary-literals">binary literals</a></li>
  <li><code class="language-plaintext highlighter-rouge">blockBindings</code> - enable <code class="language-plaintext highlighter-rouge">let</code> and <code class="language-plaintext highlighter-rouge">const</code> (aka <a href="https://leanpub.com/understandinges6/read#leanpub-auto-block-bindings">block bindings</a>)</li>
  <li><code class="language-plaintext highlighter-rouge">classes</code> - enable classes</li>
  <li><code class="language-plaintext highlighter-rouge">defaultParams</code> - enable <a href="https://leanpub.com/understandinges6/read/#leanpub-auto-default-parameters">default function parameters</a></li>
  <li><code class="language-plaintext highlighter-rouge">destructuring</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-destructuring-assignment">destructuring</a></li>
  <li><code class="language-plaintext highlighter-rouge">forOf</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-iterables-and-for-of"><code class="language-plaintext highlighter-rouge">for-of</code> loops</a></li>
  <li><code class="language-plaintext highlighter-rouge">generators</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-generators">generators</a></li>
  <li><code class="language-plaintext highlighter-rouge">modules</code> - enable modules and global strict mode</li>
  <li><code class="language-plaintext highlighter-rouge">objectLiteralComputedProperties</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-computed-property-names">computed object literal property names</a></li>
  <li><code class="language-plaintext highlighter-rouge">objectLiteralDuplicateProperties</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-duplicate-object-literal-properties">duplicate object literal properties</a> in strict mode</li>
  <li><code class="language-plaintext highlighter-rouge">objectLiteralShorthandMethods</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-method-initializer-shorthand">object literal shorthand methods</a></li>
  <li><code class="language-plaintext highlighter-rouge">objectLiteralShorthandProperties</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-property-initializer-shorthand">object literal shorthand properties</a></li>
  <li><code class="language-plaintext highlighter-rouge">octalLiterals</code> - enable <a href="https://leanpub.com/understandinges6/read#leanpub-auto-octal-and-binary-literals">octal literals</a></li>
  <li><code class="language-plaintext highlighter-rouge">regexUFlag</code> - enable the <a href="https://leanpub.com/understandinges6/read#leanpub-auto-the-regular-expression-u-flag">regular expression <code class="language-plaintext highlighter-rouge">u</code> flag</a></li>
  <li><code class="language-plaintext highlighter-rouge">regexYFlag</code> - enable the <a href="https://leanpub.com/understandinges6/read#leanpub-auto-the-regular-expression-y-flag">regular expression <code class="language-plaintext highlighter-rouge">y</code> flag</a></li>
  <li><code class="language-plaintext highlighter-rouge">restParams</code> - enable the <a href="https://leanpub.com/understandinges6/read#leanpub-auto-rest-parameters">rest parameters</a></li>
  <li><code class="language-plaintext highlighter-rouge">spread</code> - enable the <a href="https://leanpub.com/understandinges6/read#leanpub-auto-the-spread-operator">spread operator</a> for arrays</li>
  <li><code class="language-plaintext highlighter-rouge">superInFunctions</code> - enable <code class="language-plaintext highlighter-rouge">super</code> references inside of functions</li>
  <li><code class="language-plaintext highlighter-rouge">templateStrings</code> - enable <a href="https://leanpub.com/understandinges6/read/#leanpub-auto-template-strings">template strings</a></li>
  <li><code class="language-plaintext highlighter-rouge">unicodeCodePointEscapes</code> - enable <a href="https://leanpub.com/understandinges6/read/#leanpub-auto-escaping-non-bmp-characters">code point escapes</a></li>
</ul>

<p>If you’re using any of these flags, such as:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">ecmaFeatures</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">arrowFunctions</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then you should enable ES6 using <code class="language-plaintext highlighter-rouge">ecmaVersion</code>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">parserOptions</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">ecmaVersion</span><span class="p">:</span> <span class="mi">6</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If you’re using any non-ES6 flags in <code class="language-plaintext highlighter-rouge">ecmaFeatures</code>, you need to move those inside of <code class="language-plaintext highlighter-rouge">parserOptions</code>. For instance:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">ecmaFeatures</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">jsx</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Then you should move <code class="language-plaintext highlighter-rouge">ecmaFeatures</code> under <code class="language-plaintext highlighter-rouge">parserOptions</code>:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">parserOptions</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">ecmaFeatures</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">jsx</span><span class="p">:</span> <span class="kc">true</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If you were using <code class="language-plaintext highlighter-rouge">ecmaFeatures.modules</code> to enable ES6 module support like this:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">ecmaFeatures</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">modules</span><span class="p">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span>
    <span class="nl">parserOptions</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">sourceType</span><span class="p">:</span> <span class="dl">"</span><span class="s2">module</span><span class="dl">"</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Additionally, if you are using <code class="language-plaintext highlighter-rouge">context.ecmaFeatures</code> inside of your rules, then you’ll need to update your code in the following ways:</p>

<ol>
  <li>If you’re using an ES6 feature flag such as <code class="language-plaintext highlighter-rouge">context.ecmaFeatures.blockBindings</code>, rewrite to check for <code class="language-plaintext highlighter-rouge">context.parserOptions.ecmaVersion &gt; 5</code>.</li>
  <li>If you’re using <code class="language-plaintext highlighter-rouge">context.ecmaFeatures.modules</code>, rewrite to check that the <code class="language-plaintext highlighter-rouge">sourceType</code> property of the Program node is <code class="language-plaintext highlighter-rouge">"module"</code>.</li>
  <li>If you’re using a non-ES6 feature flag such as <code class="language-plaintext highlighter-rouge">context.ecmaFeatures.jsx</code>, rewrite to check for <code class="language-plaintext highlighter-rouge">context.parserOptions.ecmaFeatures.jsx</code>.</li>
</ol>

<p>If you have a plugin with rules and you are using RuleTester, then you also need to update the options you pass for rules that use <code class="language-plaintext highlighter-rouge">ecmaFeatures</code>. For example:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ruleTester</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">RuleTester</span><span class="p">();</span>
<span class="nx">ruleTester</span><span class="p">.</span><span class="nx">run</span><span class="p">(</span><span class="dl">"</span><span class="s2">no-var</span><span class="dl">"</span><span class="p">,</span> <span class="nx">rule</span><span class="p">,</span> <span class="p">{</span>
    <span class="na">valid</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="na">code</span><span class="p">:</span> <span class="dl">"</span><span class="s2">let x;</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">parserOptions</span><span class="p">:</span> <span class="p">{</span> <span class="na">ecmaVersion</span><span class="p">:</span> <span class="mi">6</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">});</span>
</code></pre></div></div>

<p>If you’re not using <code class="language-plaintext highlighter-rouge">ecmaFeatures</code> in your configuration or your custom/plugin rules and tests, then no change is needed.</p>

<h2 id="new-rules-in-eslintrecommended">New Rules in <code class="language-plaintext highlighter-rouge">"eslint:recommended"</code></h2>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint:recommended"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>In 2.0.0, the following 11 rules were added to <code class="language-plaintext highlighter-rouge">"eslint:recommended"</code>.</p>

<ul>
  <li><a href="https://eslint.org/docs/rules/constructor-super">constructor-super</a></li>
  <li><a href="https://eslint.org/docs/rules/no-case-declarations">no-case-declarations</a></li>
  <li><a href="https://eslint.org/docs/rules/no-class-assign">no-class-assign</a></li>
  <li><a href="https://eslint.org/docs/rules/no-const-assign">no-const-assign</a></li>
  <li><a href="https://eslint.org/docs/rules/no-dupe-class-members">no-dupe-class-members</a></li>
  <li><a href="https://eslint.org/docs/rules/no-empty-pattern">no-empty-pattern</a></li>
  <li><a href="https://eslint.org/docs/rules/no-new-symbol">no-new-symbol</a></li>
  <li><a href="https://eslint.org/docs/rules/no-self-assign">no-self-assign</a></li>
  <li><a href="https://eslint.org/docs/rules/no-this-before-super">no-this-before-super</a></li>
  <li><a href="https://eslint.org/docs/rules/no-unexpected-multiline">no-unexpected-multiline</a></li>
  <li><a href="https://eslint.org/docs/rules/no-unused-labels">no-unused-labels</a></li>
</ul>

<p><strong>To address:</strong> If you don’t want to be notified by those rules, you can simply disable those rules.</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint:recommended"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"no-case-declarations"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-class-assign"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-const-assign"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-dupe-class-members"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-empty-pattern"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-new-symbol"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-self-assign"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-this-before-super"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-unexpected-multiline"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"no-unused-labels"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
        </span><span class="nl">"constructor-super"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="scope-analysis-changes">Scope Analysis Changes</h2>

<p>We found some bugs in our scope analysis that needed to be addressed. Specifically, we were not properly accounting for global variables in all the ways they are defined.</p>

<p>Originally, <code class="language-plaintext highlighter-rouge">Variable</code> objects and <code class="language-plaintext highlighter-rouge">Reference</code> objects refer each other:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">Variable#references</code> property is an array of <code class="language-plaintext highlighter-rouge">Reference</code> objects which are referencing the variable.</li>
  <li><code class="language-plaintext highlighter-rouge">Reference#resolved</code> property is a <code class="language-plaintext highlighter-rouge">Variable</code> object which are referenced.</li>
</ul>

<p>But until 1.x, the following variables and references had the wrong value (empty) in those properties:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">var</code> declarations in the global.</li>
  <li><code class="language-plaintext highlighter-rouge">function</code> declarations in the global.</li>
  <li>Variables defined in config files.</li>
  <li>Variables defined in <code class="language-plaintext highlighter-rouge">/* global */</code> comments.</li>
</ul>

<p>Now, those variables and references have correct values in these properties.</p>

<p><code class="language-plaintext highlighter-rouge">Scope#through</code> property has references where <code class="language-plaintext highlighter-rouge">Reference#resolved</code> is <code class="language-plaintext highlighter-rouge">null</code>. So as a result of this change, the value of <code class="language-plaintext highlighter-rouge">Scope#through</code> property was changed also.</p>

<p><strong>To address:</strong> If you are using <code class="language-plaintext highlighter-rouge">Scope#through</code> to find references of a built-in global variable, you need to make several changes.</p>

<p>For example, this is how you might locate the <code class="language-plaintext highlighter-rouge">window</code> global variable in 1.x:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">globalScope</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getScope</span><span class="p">();</span>
<span class="nx">globalScope</span><span class="p">.</span><span class="nx">through</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">reference</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reference</span><span class="p">.</span><span class="nx">identifier</span><span class="p">.</span><span class="nx">name</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">window</span><span class="dl">"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">checkForWindow</span><span class="p">(</span><span class="nx">reference</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</code></pre></div></div>

<p>This was a roundabout way to find the variable because it was added after the fact by ESLint. The <code class="language-plaintext highlighter-rouge">window</code> variable was in <code class="language-plaintext highlighter-rouge">Scope#through</code> because the definition couldn’t be found.</p>

<p>In 2.0.0, <code class="language-plaintext highlighter-rouge">window</code> is no longer located in <code class="language-plaintext highlighter-rouge">Scope#through</code> because we have added back the correct declaration. That means you can reference the <code class="language-plaintext highlighter-rouge">window</code> object (or any other global object) directly. So the previous example would change to this:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">globalScope</span> <span class="o">=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">getScope</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">variable</span> <span class="o">=</span> <span class="nx">globalScope</span><span class="p">.</span><span class="kd">set</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">window</span><span class="dl">"</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">variable</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">variable</span><span class="p">.</span><span class="nx">references</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">checkForWindow</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Further Reading: https://estools.github.io/escope/</p>

<h2 id="default-changes-when-using-eslintrecommended">Default Changes When Using <code class="language-plaintext highlighter-rouge">eslint:recommended</code></h2>

<p>This will affect you if you are extending from <code class="language-plaintext highlighter-rouge">eslint:recommended</code>, and are enabling <a href="../rules/no-multiple-empty-lines"><code class="language-plaintext highlighter-rouge">no-multiple-empty-lines</code></a> or <a href="../rules/func-style"><code class="language-plaintext highlighter-rouge">func-style</code></a> with only a severity, such as:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint:recommended"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"no-multiple-empty-lines"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
        </span><span class="nl">"func-style"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>The rule <code class="language-plaintext highlighter-rouge">no-multiple-empty-lines</code> has no default exceptions, but in ESLint <code class="language-plaintext highlighter-rouge">1.x</code>, a default from <code class="language-plaintext highlighter-rouge">eslint:recommended</code> was applied such that a maximum of two empty lines would be permitted.</p>

<p>The rule <code class="language-plaintext highlighter-rouge">func-style</code> has a default configuration of <code class="language-plaintext highlighter-rouge">"expression"</code>, but in ESLint <code class="language-plaintext highlighter-rouge">1.x</code>, <code class="language-plaintext highlighter-rouge">eslint:recommended</code> defaulted it to <code class="language-plaintext highlighter-rouge">"declaration"</code>.</p>

<p>ESLint 2.0.0 removes these conflicting defaults, and so you may begin seeing linting errors related to these rules.</p>

<p><strong>To address:</strong>  If you would like to maintain the previous behavior, update your configuration for <code class="language-plaintext highlighter-rouge">no-multiple-empty-lines</code> by adding <code class="language-plaintext highlighter-rouge">{"max": 2}</code>, and change <code class="language-plaintext highlighter-rouge">func-style</code> to <code class="language-plaintext highlighter-rouge">"declaration"</code>. For example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint:recommended"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"no-multiple-empty-lines"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nl">"max"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">}],</span><span class="w">
        </span><span class="nl">"func-style"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s2">"declaration"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="sourcecode-constructor-node-api-changes">SourceCode constructor (Node API) changes</h2>

<p><code class="language-plaintext highlighter-rouge">SourceCode</code> constructor got to handle Unicode BOM.
If the first argument <code class="language-plaintext highlighter-rouge">text</code> has BOM, <code class="language-plaintext highlighter-rouge">SourceCode</code> constructor sets <code class="language-plaintext highlighter-rouge">true</code> to <code class="language-plaintext highlighter-rouge">this.hasBOM</code> and strips BOM from the text.</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">SourceCode</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">eslint</span><span class="dl">"</span><span class="p">).</span><span class="nx">SourceCode</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">code</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SourceCode</span><span class="p">(</span><span class="dl">"</span><span class="se">\</span><span class="s2">uFEFFvar foo = bar;</span><span class="dl">"</span><span class="p">,</span> <span class="nx">ast</span><span class="p">);</span>

<span class="nx">assert</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">hasBOM</span> <span class="o">===</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">assert</span><span class="p">(</span><span class="nx">code</span><span class="p">.</span><span class="nx">text</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">var foo = bar;</span><span class="dl">"</span><span class="p">);</span>
</code></pre></div></div>

<p>So the second argument <code class="language-plaintext highlighter-rouge">ast</code> also should be parsed from stripped text.</p>

<p><strong>To address:</strong> If you are using <code class="language-plaintext highlighter-rouge">SourceCode</code> constructor in your code, please parse the source code after it stripped BOM:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">yourParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">text</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^</span><span class="se">\u</span><span class="sr">FEFF/</span><span class="p">,</span> <span class="dl">""</span><span class="p">),</span> <span class="nx">options</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">sourceCode</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">SourceCode</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span> <span class="nx">ast</span><span class="p">);</span>
</code></pre></div></div>

<h2 id="rule-changes">Rule Changes</h2>

<ul>
  <li><a href="../rules/strict"><code class="language-plaintext highlighter-rouge">strict</code></a> - defaults to <code class="language-plaintext highlighter-rouge">"safe"</code> (previous default was <code class="language-plaintext highlighter-rouge">"function"</code>)</li>
</ul>

<h2 id="plugins-no-longer-have-default-configurations">Plugins No Longer Have Default Configurations</h2>

<p>Prior to v2.0.0, plugins could specify a <code class="language-plaintext highlighter-rouge">rulesConfig</code> for the plugin. The <code class="language-plaintext highlighter-rouge">rulesConfig</code> would automatically be applied whenever someone uses the plugin, which is the opposite of what ESLint does in every other situation (where nothing is on by default). To bring plugins behavior in line, we have removed support for <code class="language-plaintext highlighter-rouge">rulesConfig</code> in plugins.</p>

<p><strong>To address:</strong> If you are using a plugin in your configuration file, you will need to manually enable the plugin rules in the configuration file.</p>

  </article>
</main>

    <hr>

    <div class="container">

      <footer>
        <ul class="list-inline">
          
            <li><a href="https://github.com/eslint/eslint/edit/master/docs/user-guide/migrating-to-2.0.0.md">Edit this page</a></li>
          
          <li><a href="https://groups.google.com/group/eslint">Mailing List</a></li>
          <li><a href="https://github.com/eslint/eslint">GitHub</a></li>
          <li><a href="https://twitter.com/geteslint">Twitter</a></li>
          <li><a href="https://gitter.im/eslint/eslint">Chat Room</a></li>
          <li>Copyright JS Foundation and other contributors, <a href="https://js.foundation">https://js.foundation/</a></li>
        </ul>
      </footer>
    </div><!-- /.container -->

  <link href="/styles/vendor/font.css" rel="stylesheet">
  <script src="/js/vendor/jquery-1.10.2.min.js" defer></script>
  <script src="/js/vendor/bootstrap-native.min.js" defer></script>
  <script src="/js/vendor/anchor.min.js"></script>
      <!-- at the end of the BODY -->
  <script type="text/javascript" src="/js/vendor/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
    apiKey: '891b0e977d96c762a3821e0c00172ac9',
    indexName: 'eslint',
    inputSelector: '#eslint-search-input',
    algoliaOptions: { 'facetFilters': [["tags:docs", "tags:blog"]] },
    debug: false // Set debug to true if you want to inspect the dropdown
  });
  var htmlClassList = document.documentElement.classList;
  htmlClassList.remove("no-js");
  htmlClassList.add("js");
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      anchors.add('.doc h2, .doc h3, .doc h4, .blog h2, .blog h3, .blog h4');
      
	
	    var langs = {mixed: '中英文',zh: '中文',en: '英文'};
	    var last = localStorage.getItem('lang') || 'zh';

	    if (last in langs) {
	      $('.lang-chooser').html(langs[last]); 
	      $('.doc').removeClass(function(index,clz){
	          return clz.slice(3);
	      }).addClass('lang-' + last);
	    }

	    $('.navbar-left').show();

	    $('.lang-type').on('click', function() {
	        var $this = $(this),
	            type = $this.data('lang'),
	            lang = $this.html();

	        localStorage.setItem('lang', type);

	        $('.lang-chooser').html(lang); 
	        $('.doc').removeClass(function(index,clz){
	            return clz.slice(3);
	        }).addClass('lang-' + type);
	    });
	
  });
	
  </script>
  <style type="text/css">#cnzz_stat_icon_1278836435 {display: none;}</style>
  <script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278836435'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1278836435%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
  
</body>
</html>


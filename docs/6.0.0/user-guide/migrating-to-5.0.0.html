<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="keywords" content="ESLint中文, ESLint中文网, ESLint规则, ESLint配置, 代码检测, 代码质量, JavaScript, Linter, Linting, Pluggable, Configurable, Code Quality">
  <meta name="description" content="ESLint中文官网, ESLint中英文对照, JavaScript代码检测, JavaScript代码风格检测, JavaScript代码自动格式化,A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease.">
  <meta name="theme-color" content="#463fd4"/>
  <meta property="og:locale" content="zh_CN">
  <meta property="og:site_name" content="ESLint中文">
  <meta property="og:title" content="Migrating to v5.0.0">
  <meta property="og:url" content="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-5.0.0">
  <meta property="og:image" content="http://localhost:4000/img/favicon.512x512.png">

  <meta name="twitter:site" content="@geteslint">
  <meta name="twitter:title" content="Migrating to v5.0.0">
  <meta name="twitter:description" content="ESLint中文官网, ESLint中英文对照, JavaScript代码检测, JavaScript代码风格检测, JavaScript代码自动格式化,A pluggable and configurable linter tool for identifying and reporting on patterns in JavaScript. Maintain your code quality with ease.">
  <meta name="twitter:url" content="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-5.0.0">
  <meta name="twitter:card" content="summary">
  <meta name="twitter:image" content="http://localhost:4000/img/favicon.512x512.png">

    
        <title>Migrating to v5.0.0 - ESLint中文</title>
    


  <link href="http://localhost:4000/docs/6.0.0/user-guide/migrating-to-5.0.0" rel="canonical" />
  <link rel="stylesheet" href="/styles/main.css"/>
  
  <link rel="stylesheet" href="/styles/mixed.css"/>
  
  <link rel='manifest' href='http://localhost:4000/manifest.json'>
  <link rel="icon" href="http://localhost:4000/img/favicon.512x512.png">
  <link rel="alternate" type="application/rss+xml" title="ESLint中文" href="http://localhost:4000/feed.xml">
  <!-- at the end of the HEAD -->
  <link rel="stylesheet" href="/styles/vendor/docsearch.min.css" />
</head>
<body>

<input type="checkbox" id="eslint-toggle-search" class="eslint-toggle-search-checkbox" />
<header class="navbar navbar-default navbar-demo navbar-fixed-top eslint-nav" id="top" role="banner">
  <div class="container">

    <a href="http://localhost:4000/" class="navbar-brand"><img alt="ESLint" src="http://localhost:4000/img/logo.svg" itemprop="image">ESLint</a>

    <div class="eslint-navbar-toggles">
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#eslint-navbar" aria-controls="eslint-navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open">
        <span class="sr-only">Open search</span>
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </label>
    </div>

    <nav id="eslint-navbar" class="collapse navbar-collapse eslint-navbar">
      
      <ul class="nav navbar-nav navbar-left">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><span class="lang-chooser">中文</span><span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a class="lang-type" data-lang="zh" href="javascript:;">中文</a></li>
            <li><a class="lang-type" data-lang="mixed" href="javascript:;">中英文</a></li>
            <li><a class="lang-type" data-lang="en" href="javascript:;">英文</a></li>
          </ul>
        </li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="http://localhost:4000/docs/user-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">用户指南<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/docs/user-guide/getting-started">开始</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/configuring">配置</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/command-line-interface">命令行</a></li>
            <li><a href="http://localhost:4000/docs/rules/">规则</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/formatters">Formatters</a></li>
            <li><a href="http://localhost:4000/docs/user-guide/integrations">集成</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="http://localhost:4000/docs/developer-guide" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">开发指南<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/docs/developer-guide/architecture">架构</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/source-code">源码</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/development-environment">开发环境</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/contributing">参与</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/unit-tests">单元测试</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-rules">创建规则</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-custom-formatters">自定义格式化器</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-custom-parsers">自定义解析器</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/working-with-plugins">开发插件</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/shareable-configs">可共享的配置</a></li>
            <li><a href="http://localhost:4000/docs/developer-guide/nodejs-api">Node.js API</a></li>
            <li><a href="http://localhost:4000/docs/maintainer-guide">维护者指南</a></li>
          </ul>
        </li>
        <li><a href="http://localhost:4000/blog/">博客</a></li>
        <li class="dropdown">
          <a href="http://localhost:4000/demo" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">演示<span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/demo/">ESLint Demo</a></li>
            <li><a href="http://localhost:4000/parser/">Espree Demo</a></li>
          </ul>
        </li>
        <!-- <li><a href="http://localhost:4000/docs/about/">About</a></li> -->
        <li class="dropdown">
          <a href="http://localhost:4000/docs/about/" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">关于<span
              class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
            <li><a href="http://localhost:4000/users/">谁在使用 ESLint?</a></li>
            <li><a href="http://localhost:4000/team/">关于 Team</a></li>
            <li><a href="http://localhost:4000/docs/about/">关于 ESLint</a></li>
          </ul>
        </li>
      </ul>

      <label for="eslint-toggle-search" class="navbar-toggle eslint-toggle-search-open">
        <span class="sr-only">Open search</span>
        <span class="glyphicon glyphicon-search" aria-hidden="true"></span>
      </label>

      <div class="navbar-form navbar-right eslint-search" role="search">
        <div class="input-group">
          <label class="sr-only" aria-label="Search" for="eslint-search-input">Search</label>
          <div class="eslint-search-input-wrapper">
            <input type="text" class="form-control" id="eslint-search-input" accesskey="s" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search the docs...">
            <label for="eslint-toggle-search" class="eslint-toggle-search-close">
              <span class="sr-only">Close search</span>
              <span class="glyphicon glyphicon-remove-circle" aria-hidden="true"></span>
            </label>
          </div>
        </div>
      </div>
    </nav>

  </div><!-- /.container -->
</header><!-- /.navbar -->

<main class="doc lang-zh">
  <article class="container">
    <!-- Note: No pull requests accepted for this file. See README.md in the root directory for details. -->

<h1 id="migrating-to-v500">Migrating to v5.0.0</h1>

<p>ESLint v5.0.0 is the fifth major version release. We have made a few breaking changes in this release, but we expect that most users will be able to upgrade without any modifications to their build. This guide is intended to walk you through the breaking changes.</p>

<p>The lists below are ordered roughly by the number of users each change is expected to affect, where the first items are expected to affect the most users.</p>

<h3 id="breaking-changes-for-users">Breaking changes for users</h3>

<ol>
  <li><a href="#drop-node-4">Node.js 4 is no longer supported</a></li>
  <li><a href="#eslint-recommended-changes">New rules have been added to <code class="language-plaintext highlighter-rouge">eslint:recommended</code></a></li>
  <li><a href="#experimental-object-rest-spread">The <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option has been deprecated</a></li>
  <li><a href="#nonexistent-files">Linting nonexistent files from the command line is now a fatal error</a></li>
  <li><a href="#rule-default-changes">The default options for some rules have changed</a></li>
  <li><a href="#deprecated-globals">Deprecated globals have been removed from the <code class="language-plaintext highlighter-rouge">node</code>, <code class="language-plaintext highlighter-rouge">browser</code>, and <code class="language-plaintext highlighter-rouge">jest</code> environments</a></li>
  <li><a href="#empty-files">Empty files are now linted</a></li>
  <li><a href="#scoped-plugins">Plugins in scoped packages are now resolvable in configs</a></li>
  <li><a href="#multiline-directives">Multi-line <code class="language-plaintext highlighter-rouge">eslint-disable-line</code> directives are now reported as problems</a></li>
</ol>

<h3 id="breaking-changes-for-plugincustom-rule-developers">Breaking changes for plugin/custom rule developers</h3>

<ol>
  <li><a href="#parent-before-rules">The <code class="language-plaintext highlighter-rouge">parent</code> property of AST nodes is now set before rules start running</a></li>
  <li><a href="#spread-operators">When using the default parser, spread operators now have type <code class="language-plaintext highlighter-rouge">SpreadElement</code></a></li>
  <li><a href="#rest-operators">When using the default parser, rest operators now have type <code class="language-plaintext highlighter-rouge">RestElement</code></a></li>
  <li><a href="#jsx-text-nodes">When using the default parser, text nodes in JSX elements now have type <code class="language-plaintext highlighter-rouge">JSXText</code></a></li>
  <li><a href="#context-get-scope">The <code class="language-plaintext highlighter-rouge">context.getScope()</code> method now returns more proper scopes</a></li>
  <li><a href="#no-context-linter">The <code class="language-plaintext highlighter-rouge">_linter</code> property on rule context objects has been removed</a></li>
  <li><a href="#rule-tester-equality"><code class="language-plaintext highlighter-rouge">RuleTester</code> now uses strict equality checks in its assertions</a></li>
  <li><a href="#required-report-messages">Rules are now required to provide messages along with reports</a></li>
</ol>

<h3 id="breaking-changes-for-integration-developers">Breaking changes for integration developers</h3>

<ol>
  <li><a href="#source-property">The <code class="language-plaintext highlighter-rouge">source</code> property is no longer available on individual linting messages</a></li>
  <li><a href="#exit-code-two">Fatal errors now result in an exit code of 2</a></li>
  <li><a href="#non-enumerable-linter">The <code class="language-plaintext highlighter-rouge">eslint.linter</code> property is now non-enumerable</a></li>
</ol>

<hr />

<h2 id="-nodejs-4-is-no-longer-supported"><a name="drop-node-4"></a> Node.js 4 is no longer supported</h2>

<p>As of April 30th, 2018, Node.js 4 will be at EOL and will no longer be receiving security updates. As a result, we have decided to drop support for it in ESLint v5. We now support the following versions of Node.js:</p>

<ul>
  <li>Node.js 6 (6.14.0 and above)</li>
  <li>Node.js 8 (8.10.0 and above)</li>
  <li>Anything above Node.js 9.10.0</li>
</ul>

<p><strong>To address:</strong> Make sure you upgrade to at least Node.js 6 when using ESLint v5. If you are unable to upgrade, we recommend continuing to use ESLint v4.x until you are able to upgrade Node.js.</p>

<h2 id="-eslintrecommended-changes"><a name="eslint-recommended-changes"></a> <code class="language-plaintext highlighter-rouge">eslint:recommended</code> changes</h2>

<p>Two new rules have been added to the <a href="https://eslint.org/docs/user-guide/configuring#using-eslintrecommended"><code class="language-plaintext highlighter-rouge">eslint:recommended</code></a> config:</p>

<ul>
  <li><a href="/docs/rules/for-direction"><code class="language-plaintext highlighter-rouge">for-direction</code></a> enforces that a <code class="language-plaintext highlighter-rouge">for</code> loop update clause moves the counter in the right direction.</li>
  <li><a href="/docs/rules/getter-return"><code class="language-plaintext highlighter-rouge">getter-return</code></a> enforces that a <code class="language-plaintext highlighter-rouge">return</code> statement is present in property getters.</li>
</ul>

<p><strong>To address:</strong> To mimic the <code class="language-plaintext highlighter-rouge">eslint:recommended</code> behavior from 4.x, you can disable these rules in a config file:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eslint:recommended"</span><span class="p">,</span><span class="w">

  </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"for-direction"</span><span class="p">:</span><span class="w"> </span><span class="s2">"off"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"getter-return"</span><span class="p">:</span><span class="w"> </span><span class="s2">"off"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="-the-experimentalobjectrestspread-option-has-been-deprecated"><a name="experimental-object-rest-spread"></a> The <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option has been deprecated</h2>

<p>Previously, when using the default parser it was possible to use the <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option to enable support for <a href="https://developers.google.com/web/updates/2017/06/object-rest-spread">rest/spread properties</a>, as follows:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"parserOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ecmaFeatures"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"experimentalObjectRestSpread"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Object rest/spread is now an official part of the JavaScript language, so our support for it is no longer experimental. In both ESLint v4 and ESLint v5, object rest/spread can now be enabled with the <code class="language-plaintext highlighter-rouge">"ecmaVersion": 2018</code> option:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"parserOptions"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"ecmaVersion"</span><span class="p">:</span><span class="w"> </span><span class="mi">2018</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Note that this also enables parsing for other features from ES2018, such as <a href="https://github.com/tc39/proposal-async-iteration">async iteration</a>. When using ESLint v5 with the default parser, it is no longer possible to toggle syntax support for object rest/spread independently of other features.</p>

<p>For compatibility, ESLint v5 will treat <code class="language-plaintext highlighter-rouge">ecmaFeatures: { experimentalObjectRestSpread: true }</code> as an alias for <code class="language-plaintext highlighter-rouge">ecmaVersion: 2018</code> when the former is found in a config file. As a result, if you use object rest/spread, your code should still parse successfully with ESLint v5. However, note that this alias will be removed in ESLint v6.</p>

<p><strong>To address:</strong> If you use the <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option, you should be able to upgrade to ESLint v5 without any changes, but you will encounter a deprecation warning. To avoid the warning, use <code class="language-plaintext highlighter-rouge">ecmaVersion: 2018</code> in your config file rather than <code class="language-plaintext highlighter-rouge">ecmaFeatures: { experimentalObjectRestSpread: true }</code>. If you would like to disallow the use of other ES2018 features, consider using rules such as <a href="/docs/rules/no-restricted-syntax"><code class="language-plaintext highlighter-rouge">no-restricted-syntax</code></a>.</p>

<h2 id="-linting-nonexistent-files-from-the-command-line-is-now-a-fatal-error"><a name="nonexistent-files"></a> Linting nonexistent files from the command line is now a fatal error</h2>

<p>Previous versions of ESLint silently ignored any nonexistent files and globs provided on the command line:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>eslint nonexistent-file.js <span class="s1">'nonexistent-folder/**/*.js'</span> <span class="c"># exits without any errors in ESLint v4</span>
</code></pre></div></div>

<p>Many users found this behavior confusing, because if they made a typo in a filename, ESLint would appear to lint that file successfully while actually not linting anything.</p>

<p>ESLint v5 will report a fatal error when either of the following conditions is met:</p>

<ul>
  <li>A file provided on the command line does not exist</li>
  <li>A glob or folder provided on the command line does not match any lintable files</li>
</ul>

<p>Note that this also affects the <a href="https://eslint.org/docs/developer-guide/nodejs-api#cliengineexecuteonfiles"><code class="language-plaintext highlighter-rouge">CLIEngine.executeOnFiles()</code></a> API.</p>

<p><strong>To address:</strong> If you encounter an error about missing files after upgrading to ESLint v5, you may want to double-check that there are no typos in the paths you provide to ESLint. To make the error go away, you can simply remove the given files or globs from the list of arguments provided to ESLint on the command line.</p>

<p>If you use a boilerplate generator that relies on this behavior (e.g. to generate a script that runs <code class="language-plaintext highlighter-rouge">eslint tests/</code> in a new project before any test files are actually present), you can work around this issue by adding a dummy file that matches the given pattern (e.g. an empty <code class="language-plaintext highlighter-rouge">tests/index.js</code> file).</p>

<h2 id="-the-default-options-for-some-rules-have-changed"><a name="rule-default-changes"></a> The default options for some rules have changed</h2>

<ul>
  <li>The default options for the <a href="/docs/rules/object-curly-newline"><code class="language-plaintext highlighter-rouge">object-curly-newline</code></a> rule have changed from <code class="language-plaintext highlighter-rouge">{ multiline: true }</code> to <code class="language-plaintext highlighter-rouge">{ consistent: true }</code>.</li>
  <li>The default options object for the <a href="/docs/rules/no-self-assign"><code class="language-plaintext highlighter-rouge">no-self-assign</code></a> rule has changed from <code class="language-plaintext highlighter-rouge">{ props: false }</code> to <code class="language-plaintext highlighter-rouge">{ props: true }</code>.</li>
</ul>

<p><strong>To address:</strong> To restore the rule behavior from ESLint v4, you can update your config file to include the previous options:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"rules"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"object-curly-newline"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"error"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"multiline"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}],</span><span class="w">
    </span><span class="nl">"no-self-assign"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"error"</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"props"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="-deprecated-globals-have-been-removed-from-the-node-browser-and-jest-environments"><a name="deprecated-globals"></a> Deprecated globals have been removed from the <code class="language-plaintext highlighter-rouge">node</code>, <code class="language-plaintext highlighter-rouge">browser</code>, and <code class="language-plaintext highlighter-rouge">jest</code> environments</h2>

<p>Some global variables have been deprecated or removed for code running in Node.js, browsers, and Jest. (For example, browsers used to expose an <code class="language-plaintext highlighter-rouge">SVGAltGlyphElement</code> global variable to JavaScript code, but this global has been removed from web standards and is no longer present in browsers.) As a result, we have removed these globals from the corresponding <code class="language-plaintext highlighter-rouge">eslint</code> environments, so use of these globals will trigger an error when using rules such as <a href="/docs/rules/no-undef"><code class="language-plaintext highlighter-rouge">no-undef</code></a>.</p>

<p><strong>To address:</strong> If you use deprecated globals in the <code class="language-plaintext highlighter-rouge">node</code>, <code class="language-plaintext highlighter-rouge">browser</code>, or <code class="language-plaintext highlighter-rouge">jest</code> environments, you can add a <code class="language-plaintext highlighter-rouge">globals</code> section to your configuration to re-enable any globals you need. For example:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"env"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"browser"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"globals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"SVGAltGlyphElement"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="-empty-files-are-now-linted"><a name="empty-files"></a> Empty files are now linted</h2>

<p>ESLint v4 had a special behavior when linting files that only contain whitespace: it would skip running the parser and rules, and it would always return zero errors. This led to some confusion for users and rule authors, particularly when writing tests for rules. (When writing a stylistic rule, rule authors would occasionally write a test where the source code only contained whitespace, to ensure that the rule behaved correctly when no applicable code was found. However, a test like this would actually not run the rule at all, so an aspect of the rule would end up untested.)</p>

<p>ESLint v5 treats whitespace-only files the same way as all other files: it parses them and runs enabled rules on them as appropriate. This could lead to additional linting problems if you use a custom rule that reports errors on empty files.</p>

<p><strong>To address:</strong> If you have an empty file in your project and you don’t want it to be linted, consider adding it to an <a href="/docs/user-guide/configuring#ignoring-files-and-directories"><code class="language-plaintext highlighter-rouge">.eslintignore</code> file</a>.</p>

<p>If you have a custom rule, you should make sure it handles empty files appropriately. (In most cases, no changes should be necessary.)</p>

<h2 id="-plugins-in-scoped-packages-are-now-resolvable-in-configs"><a name="scoped-plugins"></a> Plugins in scoped packages are now resolvable in configs</h2>

<p>When ESLint v5 encounters a plugin name in a config starting with <code class="language-plaintext highlighter-rouge">@</code>, the plugin will be resolved as a <a href="https://docs.npmjs.com/misc/scope">scoped npm package</a>. For example, if a config contains <code class="language-plaintext highlighter-rouge">"plugins": ["@foo"]</code>, ESLint v5 will attempt to load a package called <code class="language-plaintext highlighter-rouge">@foo/eslint-plugin</code>. (On the other hand, ESLint v4 would attempt to load a package called <code class="language-plaintext highlighter-rouge">eslint-plugin-@foo</code>.) This is a breaking change because users might have been relying on ESLint finding a package at <code class="language-plaintext highlighter-rouge">node_modules/eslint-plugin-@foo</code>. However, we think it is unlikely that many users were relying on this behavior, because packages published to npm cannot contain an <code class="language-plaintext highlighter-rouge">@</code> character in the middle.</p>

<p><strong>To address:</strong> If you rely on ESLint loading a package like <code class="language-plaintext highlighter-rouge">eslint-config-@foo</code>, consider renaming the package to something else.</p>

<h2 id="-multi-line-eslint-disable-line-directives-are-now-reported-as-problems"><a name="multiline-directives"></a> Multi-line <code class="language-plaintext highlighter-rouge">eslint-disable-line</code> directives are now reported as problems</h2>

<p><code class="language-plaintext highlighter-rouge">eslint-disable-line</code> and <code class="language-plaintext highlighter-rouge">eslint-disable-next-line</code> directive comments are only allowed to span a single line. For example, the following directive comment is invalid:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span> <span class="cm">/* eslint-disable-line
   no-alert */</span> <span class="nx">alert</span><span class="p">(</span><span class="dl">'</span><span class="s1">bar</span><span class="dl">'</span><span class="p">);</span>

<span class="c1">// (which line is the rule disabled on?)</span>
</code></pre></div></div>

<p>Previously, ESLint would ignore these malformed directive comments. ESLint v5 will report an error when it sees a problem like this, so that the issue can be more easily corrected.</p>

<p><strong>To address:</strong> If you see new reported errors as a result of this change, ensure that your <code class="language-plaintext highlighter-rouge">eslint-disable-line</code> directives only span a single line. Note that “block comments” (delimited by <code class="language-plaintext highlighter-rouge">/* */</code>) are still allowed to be used for directives, provided that the block comments do not contain linebreaks.</p>

<hr />

<h2 id="-the-parent-property-of-ast-nodes-is-now-set-before-rules-start-running"><a name="parent-before-rules"></a> The <code class="language-plaintext highlighter-rouge">parent</code> property of AST nodes is now set before rules start running</h2>

<p>Previously, ESLint would set the <code class="language-plaintext highlighter-rouge">parent</code> property on each AST node immediately before running rule listeners for that node. This caused some confusion for rule authors, because the <code class="language-plaintext highlighter-rouge">parent</code> property would not initially be present on any nodes, and it was sometimes necessary to complicate the structure of a rule to ensure that the <code class="language-plaintext highlighter-rouge">parent</code> property of a given node would be available when needed.</p>

<p>In ESLint v5, the <code class="language-plaintext highlighter-rouge">parent</code> property is set on all AST nodes before any rules have access to the AST. This makes it easier to write some rules, because the <code class="language-plaintext highlighter-rouge">parent</code> property is always available rather than being mutated behind the scenes. However, as a side-effect of having <code class="language-plaintext highlighter-rouge">parent</code> properties, the AST object has a circular structure the first time a rule sees it (previously, it only had a circular structure after the first rule listeners were called). As a result, a custom rule that enumerates all properties of a node in order to traverse the AST might now loop forever or run out of memory if it does not check for cycles properly.</p>

<p><strong>To address:</strong> If you have written a custom rule that enumerates all properties of an AST node, consider excluding the <code class="language-plaintext highlighter-rouge">parent</code> property or implementing cycle detection to ensure that you obtain the correct result.</p>

<h2 id="-when-using-the-default-parser-spread-operators-now-have-type-spreadelement"><a name="spread-operators"></a> When using the default parser, spread operators now have type <code class="language-plaintext highlighter-rouge">SpreadElement</code></h2>

<p>Previously, when parsing JS code like <code class="language-plaintext highlighter-rouge">const foo = {...data}</code> with the <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option enabled, the default parser would generate an <code class="language-plaintext highlighter-rouge">ExperimentalSpreadProperty</code> node type for the <code class="language-plaintext highlighter-rouge">...data</code> spread element.</p>

<p>In ESLint v5, the default parser will now always give the <code class="language-plaintext highlighter-rouge">...data</code> AST node the <code class="language-plaintext highlighter-rouge">SpreadElement</code> type, even if the (now deprecated) <a href="#experimental-object-rest-spread"><code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code></a> option is enabled. This makes the AST compliant with the current ESTree spec.</p>

<p><strong>To address:</strong> If you have written a custom rule that relies on spread operators having the <code class="language-plaintext highlighter-rouge">ExperimentalSpreadProperty</code> type, you should update it to also work with spread operators that have the <code class="language-plaintext highlighter-rouge">SpreadElement</code> type.</p>

<h2 id="-when-using-the-default-parser-rest-operators-now-have-type-restelement"><a name="rest-operators"></a> When using the default parser, rest operators now have type <code class="language-plaintext highlighter-rouge">RestElement</code></h2>

<p>Previously, when parsing JS code like <code class="language-plaintext highlighter-rouge">const {foo, ...rest} = data</code> with the <code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code> option enabled, the default parser would generate an <code class="language-plaintext highlighter-rouge">ExperimentalRestProperty</code> node type for the <code class="language-plaintext highlighter-rouge">...data</code> rest element.</p>

<p>In ESLint v5, the default parser will now always give the <code class="language-plaintext highlighter-rouge">...data</code> AST node the <code class="language-plaintext highlighter-rouge">RestElement</code> type, even if the (now deprecated) <a href="#experimental-object-rest-spread"><code class="language-plaintext highlighter-rouge">experimentalObjectRestSpread</code></a> option is enabled. This makes the AST compliant with the current ESTree spec.</p>

<p><strong>To address:</strong> If you have written a custom rule that relies on rest operators having the <code class="language-plaintext highlighter-rouge">ExperimentalRestProperty</code> type, you should update it to also work with rest operators that have the <code class="language-plaintext highlighter-rouge">RestElement</code> type.</p>

<h2 id="-when-using-the-default-parser-text-nodes-in-jsx-elements-now-have-type-jsxtext"><a name="jsx-text-nodes"></a> When using the default parser, text nodes in JSX elements now have type <code class="language-plaintext highlighter-rouge">JSXText</code></h2>

<p>When parsing JSX code like <code class="language-plaintext highlighter-rouge">&lt;a&gt;foo&lt;/a&gt;</code>, the default parser will now give the <code class="language-plaintext highlighter-rouge">foo</code> AST node the <code class="language-plaintext highlighter-rouge">JSXText</code> type, rather than the <code class="language-plaintext highlighter-rouge">Literal</code> type. This makes the AST compliant with a recent update to the JSX spec.</p>

<p><strong>To address:</strong> If you have written a custom rule that relies on text nodes in JSX elements having the <code class="language-plaintext highlighter-rouge">Literal</code> type, you should update it to also work with nodes that have the <code class="language-plaintext highlighter-rouge">JSXText</code> type.</p>

<h2 id="-the-contextgetscope-method-now-returns-more-proper-scopes"><a name="context-get-scope"></a> The <code class="language-plaintext highlighter-rouge">context.getScope()</code> method now returns more proper scopes</h2>

<p>Previously, the <code class="language-plaintext highlighter-rouge">context.getScope()</code> method changed its behavior based on the <code class="language-plaintext highlighter-rouge">parserOptions.ecmaVersion</code> property. However, this could cause confusing behavior when using a parser that doesn’t respond to the <code class="language-plaintext highlighter-rouge">ecmaVersion</code> option, such as <code class="language-plaintext highlighter-rouge">babel-eslint</code>.</p>

<p>Additionally, <code class="language-plaintext highlighter-rouge">context.getScope()</code> incorrectly returned the parent scope of the proper scope on <code class="language-plaintext highlighter-rouge">CatchClause</code> (in ES5), <code class="language-plaintext highlighter-rouge">ForStatement</code> (in ≧ES2015), <code class="language-plaintext highlighter-rouge">ForInStatement</code> (in ≧ES2015), <code class="language-plaintext highlighter-rouge">ForOfStatement</code>, and <code class="language-plaintext highlighter-rouge">WithStatement</code> nodes.</p>

<p>In ESLint v5, the <code class="language-plaintext highlighter-rouge">context.getScope()</code> method has the same behavior regardless of <code class="language-plaintext highlighter-rouge">parserOptions.ecmaVersion</code> and returns the proper scope. See <a href="../developer-guide/working-with-rules#contextgetscope">the documentation</a> for more details on which scopes are returned.</p>

<p><strong>To address:</strong> If you have written a custom rule that uses the <code class="language-plaintext highlighter-rouge">context.getScope()</code> method in node handlers, you may need to update it to account for the modified scope information.</p>

<h2 id="-the-_linter-property-on-rule-context-objects-has-been-removed"><a name="no-context-linter"></a> The <code class="language-plaintext highlighter-rouge">_linter</code> property on rule context objects has been removed</h2>

<p>Previously, rule context objects had an undocumented <code class="language-plaintext highlighter-rouge">_linter</code> property, which was used internally within ESLint to process reports from rules. Some rules used this property to achieve functionality that was not intended to be possible for rules. For example, several plugins used the <code class="language-plaintext highlighter-rouge">_linter</code> property in a rule to monitor reports from other rules, for the purpose of checking for unused <code class="language-plaintext highlighter-rouge">/* eslint-disable */</code> directive comments. Although this functionality was useful for users, it could also cause stability problems for projects using ESLint. For example, an upgrade to a rule in one plugin could unexpectedly cause a rule in another plugin to start reporting errors.</p>

<p>The <code class="language-plaintext highlighter-rouge">_linter</code> property has been removed in ESLint v5.0, so it is no longer possible to implement rules with this functionality. However, the <a href="/docs/user-guide/command-line-interface#--report-unused-disable-directives"><code class="language-plaintext highlighter-rouge">--report-unused-disable-directives</code></a> CLI flag can be used to flag unused directive comments.</p>

<h2 id="-ruletester-now-uses-strict-equality-checks-in-its-assertions"><a name="rule-tester-equality"></a> <code class="language-plaintext highlighter-rouge">RuleTester</code> now uses strict equality checks in its assertions</h2>

<p>Previously, <code class="language-plaintext highlighter-rouge">RuleTester</code> used loose equality when making some of its assertions. For example, if a rule produced the string <code class="language-plaintext highlighter-rouge">"7"</code> as a result of autofixing, <code class="language-plaintext highlighter-rouge">RuleTester</code> would allow the number <code class="language-plaintext highlighter-rouge">7</code> in an <code class="language-plaintext highlighter-rouge">output</code> assertion, rather than the string <code class="language-plaintext highlighter-rouge">"7"</code>. In ESLint v5, comparisons from <code class="language-plaintext highlighter-rouge">RuleTester</code> use strict equality, so an assertion like this will no longer pass.</p>

<p><strong>To address:</strong> If you use <code class="language-plaintext highlighter-rouge">RuleTester</code> to write tests for your custom rules, make sure the expected values in your assertions are strictly equal to the actual values.</p>

<h2 id="-rules-are-now-required-to-provide-messages-along-with-reports"><a name="required-report-messages"></a> Rules are now required to provide messages along with reports</h2>

<p>Previously, it was possible for rules to report AST nodes without providing a report message. This was not intended behavior, and as a result the default formatter would crash if a rule omitted a message. However, it was possible to avoid a crash when using a non-default formatter, such as <code class="language-plaintext highlighter-rouge">json</code>.</p>

<p>In ESLint v5, reporting a problem without providing a message always results in an error.</p>

<p><strong>To address:</strong> If you have written a custom rule that reports a problem without providing a message, update it to provide a message along with the report.</p>

<hr />

<h2 id="-the-source-property-is-no-longer-available-on-individual-linting-messages"><a name="source-property"></a> The <code class="language-plaintext highlighter-rouge">source</code> property is no longer available on individual linting messages</h2>

<p>As announced in <a href="/blog/2016/10/eslint-v3.8.0-released#additional-property-on-linting-results">October 2016</a>, the <code class="language-plaintext highlighter-rouge">source</code> property has been removed from individual lint message objects.</p>

<p><strong>To address:</strong> If you have a formatter or integration which relies on using the <code class="language-plaintext highlighter-rouge">source</code> property on individual linting messages, you should update it to use the <code class="language-plaintext highlighter-rouge">source</code> property on file results objects instead.</p>

<h2 id="-fatal-errors-now-result-in-an-exit-code-of-2"><a name="exit-code-two"></a> Fatal errors now result in an exit code of 2</h2>

<p>When using ESLint v4, both of the following scenarios resulted in an exit code of 1 when running ESLint on the command line:</p>

<ul>
  <li>Linting completed successfully, but there are some linting errors</li>
  <li>Linting was unsuccessful due to a fatal error (e.g. an invalid config file)</li>
</ul>

<p>As a result, it was difficult for an integration to distinguish between the two cases to determine whether it should try to extract linting results from the output.</p>

<p>In ESLint v5, an unsuccessful linting run due to a fatal error will result in an exit code of 2, rather than 1.</p>

<p><strong>To address:</strong> If you have an integration that detects all problems with linting runs by checking whether the exit code is equal to 1, update it to check whether the exit code is nonzero instead.</p>

<h2 id="-the-eslintlinter-property-is-now-non-enumerable"><a name="non-enumerable-linter"></a> The <code class="language-plaintext highlighter-rouge">eslint.linter</code> property is now non-enumerable</h2>

<p>When using ESLint’s Node.js API, the <a href="/docs/developer-guide/nodejs-api#linter-1"><code class="language-plaintext highlighter-rouge">linter</code></a> property is now non-enumerable. Note that the <code class="language-plaintext highlighter-rouge">linter</code> property was deprecated in ESLint v4 in favor of the <a href="/docs/developer-guide/nodejs-api#linter"><code class="language-plaintext highlighter-rouge">Linter</code></a> property.</p>

<p><strong>To address:</strong> If you rely on enumerating all the properties of the <code class="language-plaintext highlighter-rouge">eslint</code> object, use something like <code class="language-plaintext highlighter-rouge">Object.getOwnPropertyNames</code> to ensure that non-enumerable keys are captured.</p>

  </article>
</main>

    <hr>

    <div class="container">

      <footer>
        <ul class="list-inline">
          
            <li><a href="https://github.com/eslint/eslint/edit/master/docs/user-guide/migrating-to-5.0.0.md">Edit this page</a></li>
          
          <li><a href="https://groups.google.com/group/eslint">Mailing List</a></li>
          <li><a href="https://github.com/eslint/eslint">GitHub</a></li>
          <li><a href="https://twitter.com/geteslint">Twitter</a></li>
          <li><a href="https://gitter.im/eslint/eslint">Chat Room</a></li>
          <li>Copyright JS Foundation and other contributors, <a href="https://js.foundation">https://js.foundation/</a></li>
        </ul>
      </footer>
    </div><!-- /.container -->

  <link href="/styles/vendor/font.css" rel="stylesheet">
  <script src="/js/vendor/jquery-1.10.2.min.js" defer></script>
  <script src="/js/vendor/bootstrap-native.min.js" defer></script>
  <script src="/js/vendor/anchor.min.js"></script>
      <!-- at the end of the BODY -->
  <script type="text/javascript" src="/js/vendor/docsearch.min.js"></script>
  <script type="text/javascript"> docsearch({
    apiKey: '891b0e977d96c762a3821e0c00172ac9',
    indexName: 'eslint',
    inputSelector: '#eslint-search-input',
    algoliaOptions: { 'facetFilters': [["tags:docs", "tags:blog"]] },
    debug: false // Set debug to true if you want to inspect the dropdown
  });
  var htmlClassList = document.documentElement.classList;
  htmlClassList.remove("no-js");
  htmlClassList.add("js");
  </script>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      anchors.add('.doc h2, .doc h3, .doc h4, .blog h2, .blog h3, .blog h4');
      
	
	    var langs = {mixed: '中英文',zh: '中文',en: '英文'};
	    var last = localStorage.getItem('lang') || 'zh';

	    if (last in langs) {
	      $('.lang-chooser').html(langs[last]); 
	      $('.doc').removeClass(function(index,clz){
	          return clz.slice(3);
	      }).addClass('lang-' + last);
	    }

	    $('.navbar-left').show();

	    $('.lang-type').on('click', function() {
	        var $this = $(this),
	            type = $this.data('lang'),
	            lang = $this.html();

	        localStorage.setItem('lang', type);

	        $('.lang-chooser').html(lang); 
	        $('.doc').removeClass(function(index,clz){
	            return clz.slice(3);
	        }).addClass('lang-' + type);
	    });
	
  });
	
  </script>
  <style type="text/css">#cnzz_stat_icon_1278836435 {display: none;}</style>
  <script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1278836435'%3E%3C/span%3E%3Cscript src='https://s4.cnzz.com/z_stat.php%3Fid%3D1278836435%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script>
  
</body>
</html>

